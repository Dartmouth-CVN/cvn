<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping">

<hibernate-mapping package="model">

	<!-- User tables -->
	<class name="AbsUser" table="USER">
		<id name="userId" column="USER_ID">
			<generator class="native" />
		</id>
		<discriminator column="USER-TYPE" type="string" />
		<property name="firstName" />
		<property name="lastName" />
		<property name="username" />
		<property name="password" />
		<property name="birthday" />
		<property name="room" />
		<one-to-one name="contactInfo" class="Contact" cascade="save-update"></one-to-one>
		<one-to-one name="schedule" class="Schedule" cascade="save-update"></one-to-one>

		<!-- subclasses -->
		<subclass name="Patient" discriminator-value="PATIENT">
			<join table="PATIENT">
				<key column="USER_ID" />
			</join>
		</subclass>
		<subclass name="Administrator" discriminator-value="ADMIN">
			<join table="ADMIN">
				<key column="USER_ID" />
			</join>
		</subclass>
		<subclass name="Caregiver" discriminator-value="CAREGIVER">
			<join table="CAREGIVER">
				<key column="USER_ID" />
				<property name="relation" />
				<property name="isFamily" />
			</join>
		</subclass>
		<subclass name="MedicalStaff" discriminator-value="MEDICALSTAFF">
			<join table="MEDICAL_STAFF">
				<key column="USER_ID" />
			</join>
		</subclass>
		<!-- end subclasses -->
	</class>

	<!-- end User tables -->

	<!-- Profile elements -->
	<class name="PatientProfile" table="PatientProfile">
		<id name="profileId">
			<generator class="native" />
		</id>
		<set name="pets" table="Profile_Pet">
			<key column="profileId" />
			<many-to-many column="petId" class="Pet" />
		</set>
		<set name="caregivers" table="Profile_Caregivers">
			<key column="profileId" />
			<many-to-many column="caregiverId" class="Caregiver" />
		</set>
		<set name="assignedStaff" table="Profile_MedicalStaff">
			<key column="profileId" />
			<many-to-many column="medId" class="MedicalStaff" />
		</set>
		<one-to-one name="healthProfile" class="HealthProfile"
			cascade="save-update"></one-to-one>
	</class>

	<class name="Pet" table="Pet">
		<id name="petId">
			<generator class="native" />
		</id>
		<property name="name" />
		<property name="species" />
		<property name="allergyFriendly" />
	</class>

	<class name="Meal" table="Meal">
		<id name="mealId">
			<generator class="native" />
		</id>
		<property name="rating" />
		<property name="calories" />
		<property name="notes" />
	</class>

	<class name="HealthProfile" table="HealthProfile">
		<id name="healthProfileId">
			<generator class="native" />
		</id>
		<set name="healthInfo" table="HealthProfile_HealthInfo">
			<key column="healthProfileId" />
			<many-to-many column="healthInfoId" class="HealthInfo" />
		</set>
	</class>

	<class name="HealthInfo" table="HealthInfo">
		<id name="healthInfoId">
			<generator class="native" />
		</id>
		<property name="date" type="timestamp" />
		<set name="healthAttributes" table="HealthInfo_HealthAttribute">
			<key column="healthInfoId" />
			<many-to-many column="healthAttributeId" class="HealthAttribute" />
		</set>
	</class>

	<class name="HealthAttribute" table="HealthAttribute">
		<id name="healthAttributeId">
			<generator class="native" />
		</id>
		<property name="name" />
		<property name="stringValue" />
	</class>

	<!-- ContactInfo -->
	<class name="Contact" table="Contact">
		<id name="contactId">
			<generator class="native" />
		</id>
		<set name="phoneNumbers" table="Contact_Number">
			<key column="contactId" />
			<many-to-many column="elementId" class="ContactElement" />
		</set>
		<set name="emails" table="Contact_Email">
			<key column="contactId" />
			<many-to-many column="elementId" class="ContactElement" />
		</set>
		<set name="addresses" table="Contact_Address">
			<key column="contactId" />
			<many-to-many column="elementId" class="ContactElement" />
		</set>
	</class>

	<class name="ContactElement" table="ContactElement">
		<id name="elementId">
			<generator class="native" />
		</id>
		<property name="value" />
		<property name="type" />
	</class>

	<!-- Schedule -->
	<class name="Schedule" table="Schedule">
		<id name="scheduleId">
			<generator class="native" />
		</id>
		<set name="events" table="Schedule_Event">
			<key column="scheduleId" />
			<many-to-many column="eventId" class="Event" />
		</set>
	</class>

	<class name="Event" table="Event">
		<id name="eventId">
			<generator class="native" />
		</id>
		<property name="date" type="timestamp" />
		<property name="location" />
		<property name="notes" />
	</class>
	<!-- end Schedule -->

</hibernate-mapping>